<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">

    </style>
</head>
<body>
    <canvas id="canvas" style="display: none"></canvas>
    <div id="container"></div>
    <script src="js/jquery.js" type="text/javascript"></script>
    <script src="js/three.js" type="text/javascript"></script>
    <script src="js/jquery.js" type="text/javascript"></script>
    <script type="text/javascript">
        var container = $("#container");
        var windowWidth = window.innerWidth ;
        var windowHeight = window.innerHeight;
        //scene
        var scene = new THREE.Scene();
        //renderer
        var renderer = new THREE.WebGLRenderer({antialias: true});
        renderer.setSize(windowWidth, windowHeight);
        container.append(renderer.domElement);
        renderer.setClearColor(0xcccccc);

        var light = new THREE.AmbientLight(0xffffff,1.0);
        scene.add(light);


        var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 10000);

        // position and point the camera to the center of the scene
        camera.position.x = 100;
        camera.position.y = 0;
        camera.position.z = 3000;

//        var controls = new THREE.OrbitControls( camera, renderer.domElement );
//        //controls.addEventListener( 'change', render ); // add this only if there is no animation loop (requestAnimationFrame)
//        controls.enableDamping = true;
//        controls.dampingFactor = 0.25;
//        controls.enableZoom = true;
//        //console.log(controls.enabled);



        var canvas = document.getElementById("canvas");
        var ctxt = canvas.getContext('2d');
        var img = new Image();
        img.src = 'pagedeco/1.jpg';//src也可以是从文件选择控件中取得。
        img.onload = function(){
            canvas.width = img.width;
            canvas.height = img.height;
            ctxt.drawImage(img, 0, 0,img.width, img.height);
            var data = ctxt.getImageData(0, 0, img.width, img.height).data;//读取整张图片的像素。
           console.log(data);

            for(var i =0,len = data.length; i<len;i+=4){
                var red = data[i];//红色色深
                var green = data[i+1];//绿色色深
                var blue = data[i+2];//蓝色色深
                var alpha = data[i+3];//透明度
                //因此RGB颜色就是(red, green, blue, alpha)
                var row = parseInt(i/800);
//                var color3 = new  THREE.Color(255,255,255);
//                var color3 = new  THREE.Color(data[i],data[i+1],data[i+2]);
                var ccc= "RGB("+data[i]+","+data[i+1]+","+data[i+2]+")";
                var jjj="0x"+ccc.colorHex().substring(1);
                var kkk=parseInt(jjj,16);
               // console.log(jjj+" : "+kkk);

                var cubeGeo = new THREE.CubeGeometry(1,1,1);
                var cubeMtl = new THREE.MeshLambertMaterial({color:kkk});
                var cube = new THREE.Mesh(cubeGeo,cubeMtl);
                cube.position.x=(i%800);
                cube.position.y=-row;
                scene.add(cube);
            }

            render();
            function render() {
                requestAnimationFrame(render);
//                controls.update(); // required if controls.enableDamping = true, or if controls.autoRotate = true
                renderer.render(scene, camera);
            }



        }

        var reg = /^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;
        /*RGB颜色转换为16进制*/
        String.prototype.colorHex = function(){
            var that = this;
            if(/^(rgb|RGB)/.test(that)){
                var aColor = that.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(",");
                var strHex = "#";
                for(var i=0; i<aColor.length; i++){
                    var hex = Number(aColor[i]).toString(16);
                    if(hex === "0"){
                        hex += hex;
                    }
                    strHex += hex;
                }
                if(strHex.length !== 7){
                    strHex = that;
                }
                return strHex;
            }else if(reg.test(that)){
                var aNum = that.replace(/#/,"").split("");
                if(aNum.length === 6){
                    return that;
                }else if(aNum.length === 3){
                    var numHex = "#";
                    for(var i=0; i<aNum.length; i+=1){
                        numHex += (aNum[i]+aNum[i]);
                    }
                    return numHex;
                }
            }else{
                return that;
            }
        };

        //-------------------------------------------------

        /*16进制颜色转为RGB格式*/
        String.prototype.colorRgb = function(){
            var sColor = this.toLowerCase();
            if(sColor && reg.test(sColor)){
                if(sColor.length === 4){
                    var sColorNew = "#";
                    for(var i=1; i<4; i+=1){
                        sColorNew += sColor.slice(i,i+1).concat(sColor.slice(i,i+1));
                    }
                    sColor = sColorNew;
                }
                //处理六位的颜色值
                var sColorChange = [];
                for(var i=1; i<7; i+=2){
                    sColorChange.push(parseInt("0x"+sColor.slice(i,i+2)));
                }
                return "RGB(" + sColorChange.join(",") + ")";
            }else{
                return sColor;
            }
        };



    </script>

</body>
</html>